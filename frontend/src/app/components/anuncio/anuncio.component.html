<div class="container-fluid">
  <div class="modal " id="ventanaConfirmacion" tabindex="-1" role="dialog">
    <div class="modal-dialog" >
      <div class="modal-content">
        <div class="modal-header bg-success text-white">
          <h5 class="modal-title">Ventana de confirmación</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body">
          <p>{{mensaje}}</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-success botones" data-bs-dismiss="modal" (click)="guardarAnuncio(anuncioForm)" >Aceptar</button>
        </div>
      </div>
    </div>
</div>
  <div class="row">
      <div class="col-12 mt-5 ">
          <div class="row">
            <div class=" col-10 offset-1 tabla mb-5 mt-5">
              <div class="card-body align-content-center ">
                  <div class="row">
                      <div class=" col-12 ">
                          <div class="card m-3">
                              <h5 class="card-header titulo text-center">REGISTRAR ANUNCIO</h5>
                              <div class="card-body align-content-center">
                                    <h1 class="text-center" >ANUNCIO PARA EL AREA {{redactor.area.nombreArea}}</h1>
                                    <h2 class="text-center">REDACTOR {{redactor.apellido | uppercase}}, {{redactor.nombre | uppercase}}</h2>
                              </div>                    
                        </div>
                      </div>
                      
                  </div>   
              </div>                    
          </div>             
            <div class=" col-12 col-sm-12 col-md-12 col-lg-5 offset-lg-1 mb-lg-5">
                      <div class="card m-3 tabla ">
                          <h5 class="card-header titulo text-center"> CREAR ANUNCIO</h5>                               
                          <div class="card-body align-content-center fondo letra " >
                              <div class="row">    
                                      <!-- <div class="col-12 col-md-6 col-sm-12"  > -->
                                          <!-- <div class="mb-3">
                                            <label for="recursosImg">Recursos(Imagen)</label>
                                            <input type="file" alife-file-to-base64 multiple (onFileChanged)="obtenerRutaImg($event)" accept="image/x-png,image/gif,image/jpeg"
                                                   class="form-control"  id="recursosImg" name="recursosImg" [disabled]="accion=='update'">
                                            <button class="btn btn-outline-success" type="button" (click)="guardarImagen()" [disabled] ="accion=='update'">Guardar Imagen</button>
                                          </div> -->
                                          <!-- <div class="mb-3">
                                            <label for="recursosPdf">Recursos(PDF)</label>
                                            <input type="file"  alife-file-to-base64 multiple (onFileChanged)="obtenerRutaPdf($event)" accept="file/Pdf,file/PDF"
                                                   class="form-control" id="recursosPdf" name="recursos" [disabled]="accion=='update'">
                                            <button class="btn btn-outline-success" type="button" (click)="guardarPdf()" [disabled] ="accion=='update'" >Guardar Pdf</button>
                                          </div> -->
                                         
                                          
                                      <!-- </div> -->
                                      <!-- FORMULARIO -->
                                      <div class="col-12 col-sm-12" >
                                        <form #anuncioForm="ngForm">
                                          <!-- datos del redactor no se puede cambiar  -->
                                          <!-- <div class=" mb-3 ">
                                            <label for="redactor" class="form-label ">Redactor</label>
                                            <input type="text" class="form-control" id="redactor" name="redactor" [(ngModel)]="redactor.nombre" disabled> 
                                          </div>
                                          <div class=" mb-3 ">
                                            <label for="area" class="form-label ">Area a publicar</label>
                                            <input type="text" class="form-control" id="area" name="area" [(ngModel)]="area.nombreArea" disabled> 
                                          </div> -->
                                          <!-- texto para el anuncio -->
                                          <div class=" mb-3 ">
                                              <label for="texto" class="form-label">Texto de Anuncio</label>
                                              <textarea [disabled]="accion=='update'" class="form-control" id="texto" rows="2" name="texto" [(ngModel)]="anuncio.textoAnuncio"
                                              required #texto="ngModel"></textarea> 
                                              <div *ngIf="texto.invalid && (texto.dirty || texto.touched)"
                                                  class="alert alert-danger">
                                                  <div *ngIf="texto.errors?.['required']">
                                                  Dato requerido.
                                                  </div>
                                              </div> 
                                          </div>
                                          <!-- Fecha de entrega -->
                                          <div class=" mb-3 ">
                                            <label for="fecha" class="form-label">Fecha de Vigencia </label>
                                            <input type="date" [disabled]="accion=='update'"  class="form-control" id="fecha" name="fecha" [(ngModel)]="anuncio.fechaEntrega"
                                            required #fecha="ngModel">
                                            <div *ngIf="fecha.invalid && (fecha.dirty || fecha.touched)"
                                                class="alert alert-danger">
                                                <div *ngIf="fecha.errors?.['required']">
                                                  Fecha requerida.
                                                </div>
                                            </div> 
                                          </div>
                                          <!-- Estado  -->
                                          <div class=" mb-3 "> 
                                            <label for="estado">Estado</label>
                                            <select class="form-select" id="estado" name="estado" 
                                              [(ngModel)]="anuncio.estado" required #estado="ngModel">
                                              <option value=""selected disabled>Seleccionar</option>
                                              <!-- <option value="EDICION">EDICION</option>
                                              <option value="CONFECCIONADO">CONFECCIONADO</option> -->
                                              <option [ngValue]="e" *ngFor="let e of estados">{{e}}</option>
                                            </select>
                                            <div *ngIf="estado.invalid && (estado.dirty || estado.touched)"
                                                  class="alert alert-danger">
                                                  <div *ngIf="estado.errors?.['required']">
                                                    Debe seleccionar un Estado.
                                                  </div>
                                            </div> 
                                          </div>
                                          <!-- DESTINATARIOS  -->
                                          <div class="mb-3">
                                            <!-- <label for="rol">Rol Destinado</label>
                                            <select class="form-select" id="rol" name="rol" 
                                            [(ngModel)]="anuncio.destinatario" required #rol="ngModel">
                                              <option selected disabled>Seleccionar</option>
                                              <option [ngValue]="r"  *ngFor="let r of roles">
                                                {{r.nombreRol}}
                                              </option>
                                            </select>
                                            <div *ngIf="rol.invalid && (rol.dirty || rol.touched)"
                                                  class="alert alert-danger">
                                                  <div *ngIf="rol.errors?.['required']">
                                                    Debe seleccionar un Rol.
                                                  </div>
                                            </div> -->
                                            <label for="rolM" class="form-label select-label" >Rol Destinado</label>
                                            <select [disabled]="accion=='update'"  multiple class="form-select" size="3" id="rolM" name="rolM" [(ngModel)]="anuncio.destinatario" 
                                                    required #rolM="ngModel" >
                                              <option  *ngFor="let r of roles" [ngValue]="r">{{r.nombreRol}}</option>
                                            </select>
                                            <div *ngIf="rolM.invalid && (rolM.dirty || rolM.touched)"
                                                  class="alert alert-danger">
                                                  <div *ngIf="rolM.errors?.['required']">
                                                    Debe seleccionar al menos un Rol.
                                                  </div>
                                            </div>
                                          </div>
                                          <!-- tiempo de lectura -->
                                          <div class=" mb-3 ">
                                            <label for="tiempo" class="form-label">Tiempo de Lectura</label>
                                            <input type="number" [disabled]="accion=='update'"  class="form-control" id="tiempo" name="tiempo" [(ngModel)]="anuncio.tiempoLectura"
                                            required #tiempo="ngModel" placeholder="Ingrese la cantidad de segundos que será el tiempo de lectura (En segundos)">
                                            <div *ngIf="tiempo.invalid && (tiempo.dirty || tiempo.touched)"
                                                  class="alert alert-danger">
                                                  <div *ngIf="tiempo.errors?.['required']">
                                                  Dato requerido.
                                                  </div>
                                            </div>
                                                
                                          </div>
                                          <!--destino (Medio de Publicacion)  -->
                                          <div class="mb-3">
                                            <!-- <label for="medio">Destino</label>
                                            <select class="form-select" id="medio" name="medio" 
                                            [(ngModel)]="anuncio.mediosDePublicacion" required #medio="ngModel">
                                              <option selected disabled>Seleccionar</option>
                                              <option [ngValue]="m"  *ngFor="let m of medios">
                                                {{m.nombreMedio}}
                                              </option>
                                            </select>
                      
                                            <div *ngIf="medio.invalid && (medio.dirty || medio.touched)"
                                                  class="alert alert-danger">
                                                  <div *ngIf="medio.errors?.['required']">
                                                    Debe seleccionar un Medio.
                                                  </div>
                                            </div>  -->
                                        
                                            <label for="medios" class="form-label select-label" >Medios de publicacion</label>
                                            <select multiple [disabled]="accion=='update'"  class="form-select" size="3" id="medios" name="medios" [(ngModel)]="anuncio.mediosDePublicacion"
                                                    required #medio="ngModel"  > 
                                              <option  *ngFor="let m of medios" [ngValue]="m">{{m.nombreMedio}}</option>
                                            </select>
                                            <div *ngIf="medio.invalid && (medio.dirty || medio.touched)"
                                                  class="alert alert-danger">
                                                  <div *ngIf="medio.errors?.['required']">
                                                    Debe seleccionar al menos un Medio.
                                                  </div>
                                            </div> 
                                          </div>
                                          <!-- Tipo de Imagen -->
                                          <div class=" mb-3 ">
                                            <label for="contenido" class="form-label">Tipo Contenido (URL)</label>
                                            <input type="text" [disabled]="accion=='update'"  class="form-control" id="contenido" name="contenido"
                                             [(ngModel)]="anuncio.tipoContenido" required #contenido="ngModel" placeholder="Ingrese la URL de su anuncio"> 
                                            <div *ngIf="contenido.invalid && (contenido.dirty || contenido.touched)"
                                                  class="alert alert-danger">
                                                  <div *ngIf="contenido.errors?.['required']">
                                                    Debe ingresar URL de su anuncio.
                                                  </div>
                                            </div> 
                                          </div>
                                          <div class="mb-3">
                                            <label for="recursos">Recursos</label>
                                            <form class="row ">
                                              <div class="col-8">
                                                <input type="text" class="form-control" id="recursos" name="recursos" [disabled]="accion=='update'" [(ngModel)]="archivo" 
                                                       placeholder="Ingrese Url de los recursos extras para su anuncio">
                                              </div>
                                              <div class="col-4">  
                                                <button class="btn btn-outline-dark" type="button" (click)="agregarRecurso()" [disabled] ="accion=='update' || archivo==''" >Agregar recurso</button>
                                              </div>
                                            </form>
                                           
                                           
                                          </div >
                                          <!--  -->
                                          <!-- <div class="mb-3">
                                            <qrcode (qrCodeURL)="onChangeURL($event)" [qrdata]="myAngularxQrCode" [width]="256" [errorCorrectionLevel]="'M'"></qrcode>
                                            <a [href]="qrCodeDownloadLink" download="qrcode">Download</a>
                                          </div> -->
                                          <div class="d-flex justify-content-center">
                                            <button *ngIf="accion=='new'" type="button" class="btn btn-primary botones " (click)="confirmarRegistro()"
                                            data-bs-toggle="modal" data-bs-target="#ventanaConfirmacion"
                                                [disabled]="!anuncioForm.form.valid">REGISTRAR ANUNCIO</button>
                                            <button *ngIf="accion=='update'" type="button" class="btn btn-primary botones" (click)="actualizarAnuncio()" 
                                                >ACTUALIZAR</button>
                                          </div>
                                                                                               
                                          </form>
                                    </div>

                              </div>
                          </div>   
                       </div>
            </div>
            <div class=" col-12 col-sm-12 col-md-12 col-lg-4 offset-lg-1">
              <div class="card m-3 tabla">
                      <h5 class="card-header titulo " >Archivos adjuntos</h5>
                      <div class="card-body align-content-center">
                            <table class="table">
                              <thead>
                                <tr>
                                  <th scope="col" >Listado</th>
                                  <th scope="col">Accion</th>
                                </tr>
                              </thead>
                              <tbody>
                                <tr *ngFor="let a of archivos">
                                  <td>{{a}}</td>
                                  <td>
                                    <button [disabled]="accion=='update'" type="button" class="btn btn-btn bg-danger btnAcciones" (click)="quitarRecurso(a)" >
                                            <i class="bi bi-trash3"></i>
                                    </button>
                                  </td>
                                </tr>
                              </tbody>
                            </table>
                      </div>                    
                </div>
            </div> 
          </div>    
      </div>
  </div>

</div>


